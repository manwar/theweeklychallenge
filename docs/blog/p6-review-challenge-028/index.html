<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
    <!-- Basic Page Needs -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title"       content="The Weekly Challenge - Perl & Raku"/>
    <meta property="og:type"        content="website"/>
    <meta property="og:url"         content="https://perlweeklychallenge.org/"/>
    <meta property="og:image"       content="https://perlweeklychallenge.org/images/about/about.jpg"/>
    <meta property="og:description" content="You do not have to be an expert."/>
    <meta name="twitter:card"       content="summary" />
    <meta name="twitter:image"      content="https://perlweeklychallenge.org/images/about/about.jpg"/>

    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <meta name="description" content="Laurent Rosenfeld Weekly Review: Challenge - #028.">
    <meta name="author" content="Perl Weekly Challenge Team">
    <meta name="generator" content="Hugo 0.67.0-DEV" />

    <!-- Mobile Specific Metas -->
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Laurent Rosenfeld Weekly Review: Challenge - 028</title>
    <link rel="icon" href="https://perlweeklychallenge.org/images/favicon.ico">

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css"/>

    <!-- Twitter Bootstrs CSS -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/bootstrap/bootstrap.min.css">
    <!-- Ionicons Fonts Css -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/ionicons/ionicons.min.css">
    <!-- animate css -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/animate-css/animate.css">
    <!-- Hero area slider css-->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/slider/slider.css">
    <!-- slick slider -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/slick/slick.css">
    <!-- Fancybox -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/facncybox/jquery.fancybox.css">
    <!-- hover -->
    <link rel="stylesheet" href="https://perlweeklychallenge.org/plugins/hover/hover-min.css">
    <!-- Google fonts -->
    <link href='https://fonts.googleapis.com/css?family=Source Code Pro' rel='stylesheet'>
    <!-- template main css file -->
    
    <link rel="stylesheet" href="https://perlweeklychallenge.org/css/style.min.css" integrity="" media="screen">
    <link rel="stylesheet" href="https://perlweeklychallenge.org/css/main.css">
</head>

<body>

<section class="top-bar animated-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <nav class="navbar navbar-expand-lg navbar-light bg-light">
                    <a class="navbar-brand" href="https://perlweeklychallenge.org/">
                        <img src="https://perlweeklychallenge.org/images/logo.svg" alt="logo">
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navgation" aria-controls="navigation"
                        aria-expanded="false" aria-label="Toggle navigation">
                        <span class="navbar-toggler-icon"></span>
                    </button>

                    <div class="collapse navbar-collapse" id="navigation">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/">Home</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/about">About</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/chart">Chart</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/champions">Champions</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/team">Team</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/challenges">Challenges</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/p5-reviews">Perl/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/p6-reviews">Raku/Review</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/recaps">Recaps</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/blogs">Blogs</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/faq">FAQ</a>
                            </li>
                            
                            <li class="nav-item">
                                <a class="nav-link" href="https://perlweeklychallenge.org/contact">Contact</a>
                            </li>
                            
                        </ul>
                    </div>
                </nav>
            </div>
        </div>
    </div>
</section>


<section class="global-page-header">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2>Laurent Rosenfeld Weekly Review: Challenge - 028</h2>
                    <div class="portfolio-meta">
                        <span>Sunday, Oct 13, 2019</span>|
                        <span> Tags:
                            Raku
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="single-post">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                
                <div style="text-align: center" class="post-img">
                    <img class="img-fluid" alt="" src="https://perlweeklychallenge.org/images/blog/p6-review-challenge-028.jpg">
                </div>
                
                <div style="text-align: justify" class="post-content">
                    <hr>
<h1 id="raku-solutions-weekly-review">Raku Solutions Weekly Review</h1>
<hr>
<h2 id="task-1-file-types">Task #1: File Types</h2>
<p>This is derived in part from my <a href="http://blogs.perl.org/users/laurent_r/2019/10/perl-weekly-challenge-28-file-type-and-digital-clock.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-028/">Week 28 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>
<p>The challenge reads as follows:</p>
<p><em>Write a script to check the file content without explicitly reading the content. It should accept file name with path as command line argument and print “The file content is binary.” or else “The file content is ascii.” accordingly.</em></p>
<p>On most operating systems (VMS is an exception to a certain extent), there is no 100%-reliable algorithm to know whether a file is text (ASCII or UTF-8) or binary, but only some heuristic guesses. Usually, programs that attempt to find out whether a file is text or binary read a raw block of bytes (often 4096 bytes) and make some statistics on the number of bytes corresponding to ASCII printable and space characters versus non-printable characters. If the number of non-printable character exceeds a certain fraction of the whole (for example one third, or 10%, or whatever), then the file is deemed to be binary. Also, any file containing a zero byte in the examined portion is considered a binary file.</p>
<p>In Perl 5, the <code>-T</code> and <code>-B</code> file test operators more or less work as described above.</p>
<h2 id="my-solution">My Solution</h2>
<p>Perl 6 has most of the Perl 5 test file operators (albeit with a slightly different syntax), but operators equivalent to Perl 5 <code>-T</code> and <code>-B</code> file test operators currently do not exist (or are not yet implemented). We will use the existing file test operators (<code>-e</code>, <code>-z</code> and <code>-f</code>) to check, respectively, that the file exists, that it is not empty and that it is a regular file, but we have to roll out our own <code>is-binary</code> subroutine to try to mimic the Perl 5 <code>-T</code> and <code>-B</code> operators. This subroutine will read a raw block of the first 4096 bytes of the file and examine each byte in turn to make some statistics on space characters and printable characters versus non-printable characters.</p>
<p>The slight difficulty, though, is to determine exactly what should be considered a non-printable character. For lack of a standard definition of such characters, I&rsquo;ve decided to consider that byte decimal values 0 to 8 and 14 to 31 correspond to ASCII non-printable characters. Those values will be stored in a set. With such a small number of non-printable characters compared to the full extended ASCII, the proportion of non-printable character would be around 10% on a random bytes binary file. I have decided to consider that a file shall be deemed to be text (ASCII) if there is less than one byte out of 32 that is non-printable, and binary otherwise. In addition, any file for which the buffer contains at least one null byte (value 0) is considered to be binary.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> v6;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">is</span>-binary ($file) {
    <span style="color:#66d9ef">my</span> constant non<span style="color:#f92672">-</span>printable<span style="color:#f92672">-</span>bytes <span style="color:#f92672">=</span> (<span style="color:#ae81ff">0</span><span style="color:#f92672">..</span><span style="color:#ae81ff">8</span>)<span style="color:#f92672">.</span>Set (<span style="color:#f92672">|</span>) (<span style="color:#ae81ff">14</span><span style="color:#f92672">..</span><span style="color:#ae81ff">31</span>)<span style="color:#f92672">.</span>Set;
    <span style="color:#66d9ef">my</span> constant block<span style="color:#f92672">-</span>size <span style="color:#f92672">=</span> <span style="color:#ae81ff">4096</span>;
    <span style="color:#66d9ef">my</span> $fh <span style="color:#f92672">=</span> $file<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>open(:r, :bin);
    <span style="color:#66d9ef">my</span> $buf <span style="color:#f92672">=</span> $fh<span style="color:#f92672">.</span>read(block<span style="color:#f92672">-</span>size);
    $fh<span style="color:#f92672">.</span>close;
    <span style="color:#66d9ef">my</span> ($printable, $non<span style="color:#f92672">-</span>printable) <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>;
    <span style="color:#66d9ef">for</span> $buf<span style="color:#f92672">.</span>list <span style="color:#f92672">-&gt;</span> $byte {
        <span style="color:#66d9ef">return</span> True <span style="color:#66d9ef">if</span> $byte <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>; <span style="color:#75715e"># null byte</span>
        <span style="color:#66d9ef">if</span> $byte (elem) non<span style="color:#f92672">-</span>printable<span style="color:#f92672">-</span>bytes {
            $non<span style="color:#f92672">-</span>printable<span style="color:#f92672">++</span>;
        } <span style="color:#66d9ef">else</span> {
            $printable<span style="color:#f92672">++</span>;
        }
    }
    <span style="color:#66d9ef">return</span> True <span style="color:#66d9ef">if</span> $non<span style="color:#f92672">-</span>printable <span style="color:#f92672">*</span> <span style="color:#ae81ff">31</span> <span style="color:#f92672">&gt;</span> $printable;
    False;
}

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span> ($file) {
    die <span style="color:#e6db74">&#34;File $file does not exist&#34;</span> <span style="color:#66d9ef">unless</span> $file<span style="color:#f92672">.</span>IO <span style="color:#f92672">~~</span> :e;
    die <span style="color:#e6db74">&#34;File $file is empty&#34;</span> <span style="color:#66d9ef">if</span> $file<span style="color:#f92672">.</span>IO <span style="color:#f92672">~~</span> :z;
    die <span style="color:#e6db74">&#34;File $file isn&#39;t a plain file&#34;</span> <span style="color:#66d9ef">unless</span> $file<span style="color:#f92672">.</span>IO <span style="color:#f92672">~~</span> :f;
    say is<span style="color:#f92672">-</span>binary($file) ?? <span style="color:#e6db74">&#34;File content is binary&#34;</span> <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#34;File content is text (ASCII)&#34;</span>;
}
</code></pre></div><p>This appears to work as desired:</p>
<pre><code>$ perl6 file-type.p6
Usage:
  file-type.p6 &lt;file&gt;

$ perl6 file-type.p6 foobar.baz
File foobar.baz does not exist
  in sub MAIN at file-type.p6 line 23
  in block &lt;unit&gt; at file-type.p6 line 1


$ perl6 file-type.p6 file-type.p6
File content is text (ASCII)

$ perl6 file-type.p6 amazon.pl.gz
File content is binary
</code></pre>
<h2 id="alternative-solutions">Alternative Solutions</h2>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/arne-sommer/perl6/ch-1.p6">Arne Sommer</a> used the <code>is-text</code> subroutine exported by Jonathan Worthington&rsquo;s <a href="https://github.com/jnthn/p6-data-textorbinary">Data::TextOrBinary</a> module, which applies more or less the same heuristics as the one I used above. Using such a module makes the code pretty simple:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> Data::TextOrBinary;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span> ($file, :$test-bytes = 4096)
{
  <span style="color:#66d9ef">if</span> $file<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>d
  {
    say <span style="color:#e6db74">&#34;Directory.&#34;</span>;
  }
  <span style="color:#66d9ef">elsif</span> $file<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>e
  {
    say is<span style="color:#f92672">-</span>text($file<span style="color:#f92672">.</span>IO, :$test<span style="color:#f92672">-</span>bytes)
      ?? <span style="color:#e6db74">&#34;Text file.&#34;</span>
      <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#34;Binary file.&#34;</span>;
  }
  <span style="color:#66d9ef">else</span>
  {
    say <span style="color:#e6db74">&#34;File doesn&#39;t exist.&#34;</span>;
  }
}
</code></pre></div><p>Note that Arne&rsquo;s <a href="https://perl6.eu/binary-clock.html">blog post</a> has an extended discussion about the subject, including original 7-bit ASCII versus extended 8-bit ASCII, and so on.</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/yet-ebreo/perl6/ch-1.p6">Yet Ebreo</a> also used the <code>is-text</code> function of the <a href="https://github.com/jnthn/p6-data-textorbinary">Data::TextOrBinary</a> module:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> Data::TextOrBinary;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span> (
    *@files #= Files to check if ascii/binary
) {
    <span style="color:#66d9ef">for</span> @files <span style="color:#f92672">-&gt;</span> $x {
        <span style="color:#66d9ef">if</span> (is<span style="color:#f92672">-</span>text($x<span style="color:#f92672">.</span>IO)) {
            say <span style="color:#e6db74">&#34;[$x]: The file content is ascii.&#34;</span>;
        } <span style="color:#66d9ef">else</span> {
            say <span style="color:#e6db74">&#34;[$x]: The file content is binary.&#34;</span>;
        }
    }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/athanasius/perl6/ch-1.p6">Athanasius</a> chose to use the Perl 5 <a href="https://metacpan.org/pod/File::Util">File::Util</a> module within Perl 6, which provides a good example on how Perl 6 can benefit from the Perl 5 ecosystem:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> File::Util:from<span style="color:#e6db74">&lt;Perl5&gt;</span> <span style="color:#e6db74">&lt;file_type&gt;</span>;

<span style="color:#66d9ef">BEGIN</span> say <span style="color:#e6db74">&#39;&#39;</span>;

<span style="color:#75715e">#===============================================================================</span>
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>(Str:D $path)
#===============================================================================
{
    <span style="color:#66d9ef">my</span> Str $description <span style="color:#f92672">=</span> <span style="color:#f92672">!</span> <span style="color:#f92672">.</span>e ?? <span style="color:#e6db74">&#39;This does not exist&#39;</span>      <span style="color:#f92672">!!</span>
                            <span style="color:#f92672">.</span>d ?? <span style="color:#e6db74">&#39;This is a directory&#39;</span>      <span style="color:#f92672">!!</span>
                          <span style="color:#f92672">!</span> <span style="color:#f92672">.</span>f ?? <span style="color:#e6db74">&#39;This is not a plain file&#39;</span> <span style="color:#f92672">!!</span>
                            <span style="color:#f92672">.</span>z ?? <span style="color:#e6db74">&#39;The file is empty&#39;</span>        <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#39;OK&#39;</span>
               given $path<span style="color:#f92672">.</span>IO;

    <span style="color:#66d9ef">if</span> $description <span style="color:#f92672">eq</span> <span style="color:#e6db74">&#39;OK&#39;</span>
    {
        <span style="color:#66d9ef">my</span> Str @types <span style="color:#f92672">=</span> file_type($path);

        <span style="color:#66d9ef">if</span> @types<span style="color:#f92672">.</span>elems <span style="color:#f92672">==</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">&amp;&amp;</span> @types[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">eq</span> <span style="color:#e6db74">&#39;PLAIN&#39;</span>
        {
            <span style="color:#66d9ef">my</span> Str $t1   <span style="color:#f92672">=</span> @types[<span style="color:#ae81ff">1</span>];
            $description <span style="color:#f92672">=</span> $t1 <span style="color:#f92672">eq</span> <span style="color:#e6db74">&#39;TEXT&#39;</span>   ?? <span style="color:#e6db74">&#39;The file content is text&#39;</span>   <span style="color:#f92672">!!</span>
                           $t1 <span style="color:#f92672">eq</span> <span style="color:#e6db74">&#39;BINARY&#39;</span> ?? <span style="color:#e6db74">&#39;The file content is binary&#39;</span> <span style="color:#f92672">!!</span>
                      <span style="color:#e6db74">&#39;ERROR: The file content is neither text nor binary&#39;</span>;
        }
        <span style="color:#66d9ef">else</span>
        {
            $description <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;ERROR: Unexpected file types: &#39;</span> <span style="color:#f92672">~</span> @types<span style="color:#f92672">.</span>join(<span style="color:#e6db74">&#39;, &#39;</span>);
        }
    }

    <span style="color:#e6db74">qq{&#34;$path&#34;: $description}</span><span style="color:#f92672">.</span>say;
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/kevin-colyer/perl6/ch-1.p6">Kevin Colyer</a> decided to read a single byte using the <code>getc</code> method in a <code>try</code> block in order to decide whether a file is ASCII or binary. I&rsquo;m not convinced this is very reliable, but Kevin&rsquo;s program uses some interesting Perl 6 features:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> Test;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>(Str $file where *.IO.e) {
    <span style="color:#66d9ef">my</span> $fh <span style="color:#f92672">=</span> $file<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>open;
    LEAVE try close $fh;

    <span style="color:#75715e"># attempt a single byte read explicitly in ascii</span>
    $fh<span style="color:#f92672">.</span>encoding: <span style="color:#e6db74">&#39;ascii&#39;</span>;

    try {
        $fh<span style="color:#f92672">.</span>getc;
    }
    <span style="color:#66d9ef">if</span> $! { say <span style="color:#960050;background-color:#1e0010">“</span>The file content is binary<span style="color:#f92672">.</span><span style="color:#960050;background-color:#1e0010">”</span>}
    <span style="color:#66d9ef">else</span>  { say <span style="color:#960050;background-color:#1e0010">“</span>The file content is ascii<span style="color:#f92672">.</span><span style="color:#960050;background-color:#1e0010">”</span> };
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/ulrich-rieke/perl6/ch-1.p6">Ulrich Rieke</a>, who is a new member of the team (welcome, Ulrich), used a solution similar to Kevin&rsquo;s:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>( Str $filename ) {
  <span style="color:#66d9ef">my</span> $fh <span style="color:#f92672">=</span> open $filename , :r ;
  try $fh<span style="color:#f92672">.</span>get ;
  <span style="color:#66d9ef">if</span> ( $! ) {
      say <span style="color:#e6db74">&#34;The file is binary.&#34;</span> ;
  }
  <span style="color:#66d9ef">else</span> {
      say <span style="color:#e6db74">&#34;The file is ascii.&#34;</span> ;
  }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/kevin-colyer/perl6/ch-1.p6">Markus Holzer</a> used the <a href="http://gnuwin32.sourceforge.net/packages/file.htm">file</a> external GNU Windows utility:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>( $file )
{
    <span style="color:#66d9ef">my</span> $magic <span style="color:#f92672">=</span> run( <span style="color:#e6db74">&#34;file&#34;</span>, $file, :out )<span style="color:#f92672">.</span>out<span style="color:#f92672">.</span>slurp;
    say <span style="color:#e6db74">&#34;The file content is &#34;</span>, ($magic <span style="color:#f92672">~~</span> <span style="color:#e6db74">/ \s text \, /</span> ?? <span style="color:#e6db74">&#34;ascii&#34;</span> <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#34;binary&#34;</span>);
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/feng-chang/perl6/ch-1.p6">Feng Chang</a> chose to read 16 bytes from the file and apply the <code>is-ascii</code> subroutine, which checks for bytes numeric ranges 9 to 13 and 32 to 126:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">is</span>-ascii(uint8 $c --&gt; Bool) {
    <span style="color:#ae81ff">9</span> <span style="color:#f92672">&lt;=</span> $c <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">13</span> <span style="color:#f92672">or</span> <span style="color:#ae81ff">32</span> <span style="color:#f92672">&lt;=</span> $c <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">126</span>
}
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>(Str:D $file-name where *.IO.e) {
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39;the file content is &#39;</span>;
    say   ([<span style="color:#f92672">and</span>] open($file<span style="color:#f92672">-</span>name, :r)<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">16</span>)<span style="color:#f92672">.</span>list<span style="color:#960050;background-color:#1e0010">»</span><span style="color:#f92672">.&amp;</span>{ is<span style="color:#f92672">-</span>ascii($_) }) ??
              <span style="color:#e6db74">&#39;ascii&#39;</span> <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#39;binary&#39;</span>;
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/joelle-maslak/perl6/ch-1.p6">Joelle Maslak</a> wrote a <code>File-Info</code> class, which considers bytes 7, 9 to 13 and 32 to 126 to be printable ASCII characters. Her program reads 512 bytes from the file and deems the file to be <em>possibly</em> ASCII if less that one third of the characters are non printable.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6">class File<span style="color:#f92672">-</span>Info {
    <span style="color:#66d9ef">my</span> uint8 @print<span style="color:#f92672">-</span>default;
    <span style="color:#66d9ef">BEGIN</span> {
        @print<span style="color:#f92672">-</span>default<span style="color:#f92672">.</span>push:   <span style="color:#ae81ff">7</span>; <span style="color:#75715e"># Backspace is considered a printable for this routine&#39;s purposes</span>
        @print<span style="color:#f92672">-</span>default<span style="color:#f92672">.</span>push:   <span style="color:#ae81ff">9</span>; <span style="color:#75715e"># Horizontal tab</span>
        @print<span style="color:#f92672">-</span>default<span style="color:#f92672">.</span>push:  <span style="color:#ae81ff">10</span>; <span style="color:#75715e"># Line Feed</span>
        @print<span style="color:#f92672">-</span>default<span style="color:#f92672">.</span>push:  <span style="color:#ae81ff">12</span>; <span style="color:#75715e"># Form Feed</span>
        @print<span style="color:#f92672">-</span>default<span style="color:#f92672">.</span>push:  <span style="color:#ae81ff">13</span>; <span style="color:#75715e"># Carriage Return</span>
        @print<span style="color:#f92672">-</span>default<span style="color:#f92672">.</span>push: <span style="color:#f92672">|</span>(<span style="color:#ae81ff">32</span><span style="color:#f92672">..</span><span style="color:#ae81ff">126</span>);  <span style="color:#75715e"># All other printables</span>
    }

    has Str:D  $<span style="color:#960050;background-color:#1e0010">.</span>filename is required;
    has UInt:D $<span style="color:#960050;background-color:#1e0010">.</span>bytes<span style="color:#f92672">-</span>to<span style="color:#f92672">-</span>examine <span style="color:#f92672">=</span> <span style="color:#ae81ff">512</span>;
    has Set:D  $<span style="color:#960050;background-color:#1e0010">.</span>printables <span style="color:#f92672">=</span> Set<span style="color:#f92672">.</span><span style="color:#66d9ef">new</span>(@print<span style="color:#f92672">-</span>default);
    has buf8   $<span style="color:#960050;background-color:#1e0010">!</span>start<span style="color:#f92672">-</span>block;

    method TWEAK() {
        <span style="color:#66d9ef">my</span> $fh <span style="color:#f92672">=</span> $<span style="color:#960050;background-color:#1e0010">.</span>filename<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>open: :r, :bin;
        $<span style="color:#960050;background-color:#1e0010">!</span>start<span style="color:#f92672">-</span>block <span style="color:#f92672">=</span> $fh<span style="color:#f92672">.</span>read($<span style="color:#960050;background-color:#1e0010">!</span>bytes<span style="color:#f92672">-</span>to<span style="color:#f92672">-</span>examine);
        $fh<span style="color:#f92672">.</span>close;
    }

    method possibly<span style="color:#f92672">-</span>ascii<span style="color:#f92672">-</span>printable(<span style="color:#f92672">--&gt;</span>Bool:D) {
        <span style="color:#66d9ef">return</span> False <span style="color:#66d9ef">if</span> <span style="color:#ae81ff">0</span> <span style="color:#960050;background-color:#1e0010">∈</span> $<span style="color:#960050;background-color:#1e0010">!</span>start<span style="color:#f92672">-</span>block;  <span style="color:#75715e"># Nul chars are automatic binary</span>

        <span style="color:#66d9ef">my</span> $unprintable <span style="color:#f92672">=</span> $<span style="color:#960050;background-color:#1e0010">!</span>start<span style="color:#f92672">-</span>block<span style="color:#f92672">.</span>grep( <span style="color:#f92672">*</span> <span style="color:#960050;background-color:#1e0010">∈</span> @<span style="color:#960050;background-color:#1e0010">($!</span>printables) )<span style="color:#f92672">.</span>elems;
        <span style="color:#66d9ef">return</span> False <span style="color:#66d9ef">if</span> ($unprintable <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>) <span style="color:#f92672">&gt;</span> $<span style="color:#960050;background-color:#1e0010">!</span>start<span style="color:#f92672">-</span>block<span style="color:#f92672">.</span>elems;

        <span style="color:#75715e"># It&#39;s possibly ascii.</span>
        <span style="color:#66d9ef">return</span> True;
    }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/ruben-westerberg/perl6/ch-1.p6">Ruben Westerberg</a> based his determination of the file type on the file extension:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#75715e">#!/usr/bin/env perl6</span>
<span style="color:#66d9ef">my</span> %ext;
data<span style="color:#f92672">.</span>lines<span style="color:#f92672">.</span>map({
    <span style="color:#66d9ef">my</span> @f<span style="color:#f92672">=.</span>split(<span style="color:#e6db74">/\s|\,/</span>,:skip<span style="color:#f92672">-</span>empty);
    <span style="color:#66d9ef">my</span> $type<span style="color:#f92672">=</span> <span style="color:#e6db74">/^text\//</span> ?? <span style="color:#e6db74">&#34;text&#34;</span> <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#34;binary&#34;</span> given @f<span style="color:#f92672">.</span>shift;
    %ext{$_}<span style="color:#f92672">=</span>$type <span style="color:#66d9ef">for</span> @f;
});

@<span style="color:#960050;background-color:#1e0010">*</span>ARGS<span style="color:#f92672">.</span>map({
    <span style="color:#66d9ef">my</span> $type<span style="color:#f92672">=</span>%ext{<span style="color:#f92672">.</span>IO<span style="color:#f92672">.</span>extension};
    $type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;binary&#34;</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">!</span>$type;
    put <span style="color:#e6db74">&#34;$_: The file content is $type&#34;</span>;
});

<span style="color:#75715e">#emulate perl5 DATA section... sort of..</span>
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">data</span>() {
    q:to<span style="color:#e6db74">/END/</span>
    text<span style="color:#f92672">/</span>html                                        html htm shtml
    text<span style="color:#f92672">/</span>css                                         css
    text<span style="color:#f92672">/</span>xml                                         xml
    text<span style="color:#f92672">/</span>mathml                                      mml
    text<span style="color:#f92672">/</span>plain                                       txt
    text<span style="color:#f92672">/</span>vnd<span style="color:#f92672">.</span>sun<span style="color:#f92672">.</span>j2me<span style="color:#f92672">.</span>app<span style="color:#f92672">-</span>descriptor                 jad
    text<span style="color:#f92672">/</span>vnd<span style="color:#f92672">.</span>wap<span style="color:#f92672">.</span>wml                                 wml
    text<span style="color:#f92672">/</span>x<span style="color:#f92672">-</span>component                                 htc
    <span style="color:#66d9ef">END</span>
}
</code></pre></div><h2 id="task-2-digital-clock">Task #2: Digital Clock</h2>
<p>This is derived in part from my <a href="http://blogs.perl.org/users/laurent_r/2019/10/perl-weekly-challenge-28-file-type-and-digital-clock.html">blog post</a> made in answer to the <a href="https://perlweeklychallenge.org/blog/perl-weekly-challenge-028/">Week 28 of the Perl Weekly Challenge</a> organized by  <a href="http://blogs.perl.org/users/mohammad_s_anwar/">Mohammad S. Anwar</a> as well as answers made by others to the same challenge.</p>
<p>The challenge reads as follows:</p>
<p><em>Write a script to display Digital Clock. Feel free to be as creative as you can when displaying digits. We expect bare minimum something like “14:10:11”.</em></p>
<h2 id="my-solutions">My Solutions</h2>
<p>We can use a Perl6 one-liner:</p>
<pre><code>$ perl6 -e 'loop { my $d = DateTime.now; printf &quot;\r%02d:%02d:%02d&quot;, $d.hour, $d.minute, $d.second; sleep 1;'
14:35:06
</code></pre>
<p>Two interesting things to say about it: first, we use the <code>\r</code> (carriage return) to go back to the first column of the screen and overwrite the previously displayed time with the new one each time we want to display a new time. This useless <code>\r</code> carriage return character (dating from old typewriters) is often a pain in the neck when dealing with Windows-generated files under Unix or Linux (or the other way around), I&rsquo;m happy that I could find here some useful purpose for this pesky and usually useless character. Also note that this program uses <code>printf</code> with a formatting string to make sure that each number is printed over two characters (with a leading zero when needed). This program will run &ldquo;forever&rdquo;, until you kill it with a <code>Ctrl C</code> command. It would be easy to add a counter to stop it after a while, if needed.</p>
<p>This can actually be made simpler:</p>
<pre><code>$ ./perl6 -e 'loop {print &quot;\r&quot;, DateTime.now.hh-mm-ss;}'
14:38:06
</code></pre>
<p>So, job done? Yes, sure, we&rsquo;re displaying a digital clock. But the task specification suggests to feel free to be creative when displaying the digits. So, let&rsquo;s try to get a nicer output. We could probably use some graphical library such as <code>Tk</code>, but I haven&rsquo;t used it for a fairly long time and I&rsquo;m also not sure how to use it in Perl 6. We could also possibly use an HTML display, but I fear that would require to run a Web server, and I don&rsquo;t want to run into annoying environment problems. So I decided to simply display the time with ASCII art.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> v6;

<span style="color:#66d9ef">my</span> @digit_strings <span style="color:#f92672">=</span> (
<span style="color:#e6db74">&#39; _  -   - _  -_  -    - _  - _  - _  - _  - _  -     &#39;</span>,
<span style="color:#e6db74">&#39;| | - | - _| -_| -|_| -|_  -|_  -  | -|_| -|_| -  O  &#39;</span>,
<span style="color:#e6db74">&#39;|_| - | -|_  -_| -  | - _| -|_| -  | -|_| - _| -  O  &#39;</span>,
<span style="color:#e6db74">&#39;    -   -    -   -    -    -    -    -    -    -     &#39;</span>);

<span style="color:#66d9ef">my</span> @digits <span style="color:#f92672">=</span> map { [split <span style="color:#e6db74">/\-/</span>, $_] }, @digit_strings;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">display_time</span> (Str $time) {
    <span style="color:#66d9ef">my</span> @pieces <span style="color:#f92672">=</span> $time<span style="color:#f92672">.</span>comb;
    <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">0</span><span style="color:#f92672">..</span><span style="color:#ae81ff">3</span> <span style="color:#f92672">-&gt;</span> $line {
        <span style="color:#66d9ef">for</span> @pieces <span style="color:#e6db74">&lt;-&gt;</span> $digit {
            $digit <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span> <span style="color:#66d9ef">if</span> $digit <span style="color:#f92672">eq</span> <span style="color:#e6db74">&#34;:&#34;</span>;
            <span style="color:#66d9ef">print</span> @digits[$line][$digit];
        }
    say <span style="color:#e6db74">&#34;&#34;</span>;
    }
}

<span style="color:#66d9ef">my</span> $clear_screen <span style="color:#f92672">=</span> ($<span style="color:#960050;background-color:#1e0010">*</span>VM<span style="color:#f92672">.</span>osname <span style="color:#f92672">~~</span> m:i<span style="color:#e6db74">/cyg | lin/</span>) ?? <span style="color:#e6db74">&#34;clear&#34;</span> <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#34;cls&#34;</span>;
loop {
    <span style="color:#66d9ef">my</span> $d <span style="color:#f92672">=</span> DateTime<span style="color:#f92672">.</span>now;
    <span style="color:#66d9ef">my</span> $time_str <span style="color:#f92672">=</span> sprintf <span style="color:#e6db74">&#34;%02d:%02d:%02d&#34;</span>, $d<span style="color:#f92672">.</span>hour, $d<span style="color:#f92672">.</span>minute, $d<span style="color:#f92672">.</span>second;
    shell $clear_screen;
    display_time $time_str;
    sleep <span style="color:#ae81ff">1</span>;
}

<span style="color:#f92672">=</span>finish

Example of displayed time:
    _        _   _        _   _
 <span style="color:#f92672">|</span>   <span style="color:#f92672">|</span>   O  <span style="color:#f92672">|</span> <span style="color:#f92672">|</span> <span style="color:#f92672">|</span>_<span style="color:#f92672">|</span>   O  <span style="color:#f92672">|</span> <span style="color:#f92672">|</span>  _<span style="color:#f92672">|</span>
 <span style="color:#f92672">|</span>   <span style="color:#f92672">|</span>   O  <span style="color:#f92672">|</span>_<span style="color:#f92672">|</span>  _<span style="color:#f92672">|</span>   O  <span style="color:#f92672">|</span>_<span style="color:#f92672">|</span> <span style="color:#f92672">|</span>_
</code></pre></div><h2 id="alternative-solutions-1">Alternative Solutions</h2>
<p>Quite a few of the solutions below used system-specific features that did not work for me, despite trying them under Windows, Linux and Cygwin. The fact that I wasn&rsquo;t able to run a solution doesn&rsquo;t mean that it is a bad solution</p>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/arne-sommer/perl6/ch-2.p6">Arne Sommer</a> also used ASCII art to display a digital clock, but his digits are much more elaborated than mine:</p>
<pre><code>   ,a8888a,         88           88  888888888888               ,d8        88
 ,8P&quot;'  `&quot;Y8,     ,d88  888    ,d88          ,8P'  888        ,d888      ,d88
,8P        Y8,  888888  888  888888         d8&quot;    888      ,d8&quot; 88    888888
88          88      88           88       ,8P'            ,d8&quot;   88        88
88          88      88           88      d8&quot;            ,d8&quot;     88        88
`8b        d8'      88  888      88    ,8P'        888  8888888888888      88
 `8ba,  ,ad8'       88  888      88   d8&quot;          888           88        88
   &quot;Y8888P&quot;         88           88  8P'                         88        88
</code></pre>
<p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/athanasius/perl6/ch-2.p6">Athanasius</a> wrote a <code>while</code> loop using the <code>\r</code> carriage return character to overwrite the previous display with the new one each time, just as in my one-liners:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">while</span> <span style="color:#ae81ff">1</span>
{
    sleep <span style="color:#ae81ff">1</span>;

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">++</span>$sec <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">60</span>
    {
        $sec <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">++</span>$min <span style="color:#f92672">==</span> <span style="color:#ae81ff">60</span>
        {
            $min  <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
            $hour <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">if</span> <span style="color:#f92672">++</span>$hour <span style="color:#f92672">==</span> <span style="color:#ae81ff">24</span>;
        }
    }

    <span style="color:#e6db74">&#34;%02d:%02d:%02d\r&#34;</span><span style="color:#f92672">.</span>printf($hour, $min, $sec);
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/daniel-mita/perl6/ch-2.p6">Daniel Mita</a> suggested a program which I don&rsquo;t fully understand and which I could not run (perhaps not the right terminal):</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">my</span> @num<span style="color:#f92672">-</span>groups <span style="color:#f92672">=</span> (<span style="color:#f92672">^</span><span style="color:#ae81ff">0x20000</span>)
  <span style="color:#f92672">.</span>map( { <span style="color:#f92672">.</span>chr } )
  <span style="color:#f92672">.</span>grep( { <span style="color:#f92672">.</span>uniprop <span style="color:#f92672">eq</span> <span style="color:#e6db74">&#34;Nd&#34;</span> } )
  <span style="color:#f92672">.</span>rotor(<span style="color:#ae81ff">10</span>)
  <span style="color:#f92672">.</span>map( { ( <span style="color:#f92672">^</span><span style="color:#ae81ff">10</span> Z<span style="color:#f92672">=&gt;</span> $_ )<span style="color:#f92672">.</span>Hash } );

loop {
  run <span style="color:#e6db74">&#39;clear&#39;</span>;
  given DateTime<span style="color:#f92672">.</span>now <span style="color:#f92672">-&gt;</span> $t {
    <span style="color:#66d9ef">for</span> @num<span style="color:#f92672">-</span>groups <span style="color:#f92672">-&gt;</span> %nums {
      once {<span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#39; &#39;</span> x <span style="color:#ae81ff">8</span> <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;\t&#34;</span>}
      <span style="color:#66d9ef">print</span> $t<span style="color:#f92672">.</span>hh<span style="color:#f92672">-</span>mm<span style="color:#f92672">-</span>ss<span style="color:#f92672">.</span>comb<span style="color:#f92672">.</span>map( { %nums{$_}
        <span style="color:#f92672">||</span> <span style="color:#66d9ef">do</span> given %nums{<span style="color:#ae81ff">0</span>}<span style="color:#f92672">.</span>uniprop(<span style="color:#e6db74">&#39;Block&#39;</span>) {
          when <span style="color:#e6db74">&#39;Arabic&#39;</span> {<span style="color:#e6db74">&#39;؛&#39;</span>}
          when <span style="color:#e6db74">&#39;NKo&#39;</span>    {<span style="color:#e6db74">&#39;߸&#39;</span>}
          default       {<span style="color:#e6db74">&#39;:&#39;</span>}
        }} )<span style="color:#f92672">.</span>join;
      <span style="color:#66d9ef">print</span> $+<span style="color:#f92672">+</span> % 3 ?? <span style="color:#e6db74">&#34;\t&#34;</span> <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#34;\n&#34;</span>;
    }
    sleep <span style="color:#ae81ff">0.1</span> <span style="color:#66d9ef">while</span> $t<span style="color:#f92672">.</span>whole<span style="color:#f92672">-</span>second <span style="color:#f92672">==</span> DateTime<span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>whole<span style="color:#f92672">-</span>second;
  }
}
</code></pre></div><p>I also could not run <a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/markus-holzer/perl6/ch-2.p6">Markus Holzer</a> solution, probably for similar reasons:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6">
subset CoordStr of Str where <span style="color:#e6db74">/ ^ \d+ \, \d+ $ /</span>;

<span style="color:#66d9ef">my</span> @numbers <span style="color:#f92672">=</span> map <span style="color:#f92672">*.</span>comb(<span style="color:#ae81ff">3</span>)<span style="color:#f92672">.</span>Array,
    <span style="color:#e6db74">&#34;╻━╻┃ ┃╹━╹&#34;</span>, <span style="color:#e6db74">&#34;  ╻  ┃  ╹&#34;</span>, <span style="color:#e6db74">&#34;╺━╻╻━╹╹━╸&#34;</span>, <span style="color:#e6db74">&#34;╺━╻╺━┃╺━╹&#34;</span>, <span style="color:#e6db74">&#34;╻ ╻╹━┃  ╹&#34;</span>,
    <span style="color:#e6db74">&#34;╻━╸╹━╻╺━╹&#34;</span>, <span style="color:#e6db74">&#34;╻━╸┃━╻╹━╹&#34;</span>, <span style="color:#e6db74">&#34;╺━╻  ┃  ╹&#34;</span>, <span style="color:#e6db74">&#34;╻━╻┃━┃╹━╹&#34;</span>, <span style="color:#e6db74">&#34;╻━╻╹━┃╺━╹&#34;</span>;

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>( CoordStr :$at = &#34;2,2&#34; )
{
    <span style="color:#66d9ef">my</span> ($x, $y) <span style="color:#f92672">=</span> $at<span style="color:#f92672">.</span>Str<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#39;,&#39;</span>);

    react {
        whenever Supply<span style="color:#f92672">.</span>interval(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">-&gt;</span> $v {
            <span style="color:#66d9ef">print</span> clear<span style="color:#f92672">-</span>screen;
            display<span style="color:#f92672">-</span>time( $x, $y, DateTime<span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>hh<span style="color:#f92672">-</span>mm<span style="color:#f92672">-</span>ss );
            <span style="color:#66d9ef">print</span> go<span style="color:#f92672">-</span>to(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>);
        }

        whenever signal(SIGINT) { exit <span style="color:#ae81ff">0</span>; }
    }
}

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">display</span>-time( $x, $y, $time )
{
    <span style="color:#66d9ef">for</span> $time<span style="color:#f92672">.</span>comb<span style="color:#f92672">.</span>kv <span style="color:#f92672">-&gt;</span> $column, $part
    {
        <span style="color:#66d9ef">if</span> $part <span style="color:#f92672">~~</span> <span style="color:#e6db74">/\d/</span>
        {
            <span style="color:#66d9ef">for</span> <span style="color:#f92672">|</span>@numbers[$part]<span style="color:#f92672">.</span>kv <span style="color:#f92672">-&gt;</span> $idx, $line
            {
                <span style="color:#66d9ef">print</span> go<span style="color:#f92672">-</span>to( $x <span style="color:#f92672">+</span> ($column <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>), $y <span style="color:#f92672">+</span> $idx ) <span style="color:#f92672">~</span> $line;
            }
        }
        <span style="color:#66d9ef">else</span>
        {
            <span style="color:#66d9ef">print</span> go<span style="color:#f92672">-</span>to( $x <span style="color:#f92672">+</span> ($column <span style="color:#f92672">*</span> <span style="color:#ae81ff">3</span>) , $y <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>) <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34; : &#34;</span>;
        }
    }
}

<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">clear</span>-screen() { escape(<span style="color:#e6db74">&#34;2J&#34;</span>) <span style="color:#f92672">~</span> escape(<span style="color:#e6db74">&#34;;H&#34;</span>); }
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">go</span>-to( $column, $row ) { escape( <span style="color:#e6db74">&#34;$row;$column&#34;</span> <span style="color:#f92672">~</span> <span style="color:#e6db74">&#34;H&#34;</span> ); }
<span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">escape</span>( $value ) { <span style="color:#e6db74">&#34;\e[&#34;</span> <span style="color:#f92672">~</span> $value; }
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/kevin-colyer/perl6/ch-2.p6">Kevin Colyer</a> wrote a bare-bone program essentially similar to one of my one-liners:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>() {
    <span style="color:#75715e"># bare minimum</span>
    say DateTime<span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>hh<span style="color:#f92672">-</span>mm<span style="color:#f92672">-</span>ss;
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/simon-proctor/perl6/ch-2.p6">Simon Proctor</a> used the <code>\r</code> carriage-return character to do something similar to my one-liners:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6">multi <span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>() {
    <span style="color:#66d9ef">END</span> say <span style="color:#e6db74">&#34;&#34;</span>;
    loop {
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;{DateTime.now.hh-mm-ss}&#34;</span>;
        sleep <span style="color:#ae81ff">1</span>;
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;\r&#34;</span>;
    }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/ulrich-rieke/perl6/ch-2.p6">Ulrich Rieke</a>&lsquo;s solution uses an external <code>figlet</code> command which I do not know and can&rsquo;t test adequately:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">use</span> v6 ;
run <span style="color:#e6db74">&#39;figlet&#39;</span> , <span style="color:#e6db74">&#34;{DateTime.now.Str.substr(11,8)}&#34;</span> ;
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/feng-chang/perl6/ch-2.p6">Feng Chang</a> also suggested a solution which I am not able to run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">my</span> $clock <span style="color:#f92672">=</span> Supply<span style="color:#f92672">.</span>interval: <span style="color:#ae81ff">1</span>;
$clock<span style="color:#f92672">.</span>tap: { <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;\r&#34;</span>, DateTime<span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>hh<span style="color:#f92672">-</span>mm<span style="color:#f92672">-</span>ss };

signal(SIGINT)<span style="color:#f92672">.</span>tap({ put <span style="color:#e6db74">&#34;\r{ DateTime.now.hh-mm-ss }  &#34;</span>; exit <span style="color:#ae81ff">0</span>; });
sleep <span style="color:#960050;background-color:#1e0010">∞</span>;
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/joelle-maslak/perl6/ch-2.p6">Joelle M%aslak</a> used a solution similar to one of my one-liners:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">sub</span> <span style="color:#a6e22e">MAIN</span>() {
    say DateTime<span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>hh<span style="color:#f92672">-</span>mm<span style="color:#f92672">-</span>ss;
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/ruben-westerberg/perl6/ch-2.p6">Ruben Westerberg</a> provided code using supplies, <code>react</code> and <code>whenever</code> features and I must admit that I get an idea of what it is doing, but don&rsquo;t fully understand it:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">my</span> $offset<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>;
<span style="color:#75715e">#my @codes=(&#34;\x1b[{$offset}D&#34;</span>
react { whenever Supply<span style="color:#f92672">.</span>interval(<span style="color:#ae81ff">.1</span>) {
    <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;=&#34;</span>;
}
    whenever Supply<span style="color:#f92672">.</span>interval(<span style="color:#ae81ff">1</span>) {
        <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;\x1b[2K&#34;</span>;
         <span style="color:#66d9ef">print</span> <span style="color:#e6db74">&#34;\x1b[1000D&#34;</span>;
        <span style="color:#66d9ef">print</span> DateTime<span style="color:#f92672">.</span>now<span style="color:#f92672">.</span>hh<span style="color:#f92672">-</span>mm<span style="color:#f92672">-</span>ss;
     }
}
</code></pre></div><p><a href="https://github.com/manwar/perlweeklychallenge-club/blob/master/challenge-028/yet-ebreo/perl6/ch-2.p6">Yet Ebreo</a> provided an ASCII art solution:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-Perl6" data-lang="Perl6"><span style="color:#66d9ef">my</span> @ascii_num<span style="color:#f92672">=</span> (
    [<span style="color:#e6db74">&#34;  0000  &#34;</span>,<span style="color:#e6db74">&#34; 00  00 &#34;</span>,<span style="color:#e6db74">&#34; 00  00 &#34;</span>,<span style="color:#e6db74">&#34; 00  00 &#34;</span>,<span style="color:#e6db74">&#34;  0000  &#34;</span>],
    [<span style="color:#e6db74">&#34;   11   &#34;</span>,<span style="color:#e6db74">&#34;   11   &#34;</span>,<span style="color:#e6db74">&#34;   11   &#34;</span>,<span style="color:#e6db74">&#34;   11   &#34;</span>,<span style="color:#e6db74">&#34;   11   &#34;</span>],
    [<span style="color:#e6db74">&#34; 222222 &#34;</span>,<span style="color:#e6db74">&#34;     22 &#34;</span>,<span style="color:#e6db74">&#34; 222222 &#34;</span>,<span style="color:#e6db74">&#34; 22     &#34;</span>,<span style="color:#e6db74">&#34; 222222 &#34;</span>],
    [<span style="color:#e6db74">&#34; 333333 &#34;</span>,<span style="color:#e6db74">&#34;     33 &#34;</span>,<span style="color:#e6db74">&#34; 333333 &#34;</span>,<span style="color:#e6db74">&#34;     33 &#34;</span>,<span style="color:#e6db74">&#34; 333333 &#34;</span>],
    [<span style="color:#e6db74">&#34; 44  44 &#34;</span>,<span style="color:#e6db74">&#34; 44  44 &#34;</span>,<span style="color:#e6db74">&#34; 444444 &#34;</span>,<span style="color:#e6db74">&#34;     44 &#34;</span>,<span style="color:#e6db74">&#34;     44 &#34;</span>],
    [<span style="color:#e6db74">&#34; 555555 &#34;</span>,<span style="color:#e6db74">&#34; 55     &#34;</span>,<span style="color:#e6db74">&#34; 555555 &#34;</span>,<span style="color:#e6db74">&#34;     55 &#34;</span>,<span style="color:#e6db74">&#34; 555555 &#34;</span>],
    [<span style="color:#e6db74">&#34; 666666 &#34;</span>,<span style="color:#e6db74">&#34; 66     &#34;</span>,<span style="color:#e6db74">&#34; 666666 &#34;</span>,<span style="color:#e6db74">&#34; 66  66 &#34;</span>,<span style="color:#e6db74">&#34; 666666 &#34;</span>],
    [<span style="color:#e6db74">&#34; 777777 &#34;</span>,<span style="color:#e6db74">&#34;     77 &#34;</span>,<span style="color:#e6db74">&#34;     77 &#34;</span>,<span style="color:#e6db74">&#34;     77 &#34;</span>,<span style="color:#e6db74">&#34;     77 &#34;</span>],
    [<span style="color:#e6db74">&#34; 888888 &#34;</span>,<span style="color:#e6db74">&#34; 88  88 &#34;</span>,<span style="color:#e6db74">&#34; 888888 &#34;</span>,<span style="color:#e6db74">&#34; 88  88 &#34;</span>,<span style="color:#e6db74">&#34; 888888 &#34;</span>],
    [<span style="color:#e6db74">&#34; 999999 &#34;</span>,<span style="color:#e6db74">&#34; 99  99 &#34;</span>,<span style="color:#e6db74">&#34; 999999 &#34;</span>,<span style="color:#e6db74">&#34;     99 &#34;</span>,<span style="color:#e6db74">&#34; 999999 &#34;</span>],
    [<span style="color:#e6db74">&#34;    &#34;</span>,<span style="color:#e6db74">&#34; :: &#34;</span>,<span style="color:#e6db74">&#34;    &#34;</span>,<span style="color:#e6db74">&#34; :: &#34;</span>,<span style="color:#e6db74">&#34;    &#34;</span>],
    [<span style="color:#e6db74">&#34;    &#34;</span>,<span style="color:#e6db74">&#34;    &#34;</span>,<span style="color:#e6db74">&#34;    &#34;</span>,<span style="color:#e6db74">&#34;    &#34;</span>,<span style="color:#e6db74">&#34;    &#34;</span>]
);
<span style="color:#66d9ef">my</span> $toggler <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
loop {
    <span style="color:#66d9ef">my</span> $dig_time <span style="color:#f92672">=</span> DateTime<span style="color:#f92672">.</span>now;
    <span style="color:#66d9ef">my</span> @printline;

    $toggler <span style="color:#f92672">=</span> <span style="color:#f92672">!</span>$toggler;
    <span style="color:#66d9ef">for</span> $dig_time<span style="color:#f92672">.</span>hh<span style="color:#f92672">-</span>mm<span style="color:#f92672">-</span>ss<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;&#34;</span>,:skip<span style="color:#f92672">-</span>empty) <span style="color:#f92672">-&gt;</span> $x {
        <span style="color:#66d9ef">for</span> (<span style="color:#ae81ff">0</span> <span style="color:#f92672">..</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">-&gt;</span> $i {
            @printline[$i] <span style="color:#f92672">~=</span> @ascii_num[ ($x<span style="color:#f92672">~~</span><span style="color:#e6db74">/\:/</span>) ?? ( $toggler ?? <span style="color:#ae81ff">10</span> <span style="color:#f92672">!!</span> <span style="color:#ae81ff">11</span>) <span style="color:#f92672">!!</span> $x ][$i];
        }
    }

    <span style="color:#75715e">#This might cause flicker</span>
    shell (($<span style="color:#960050;background-color:#1e0010">*</span>DISTRO<span style="color:#f92672">.</span>name <span style="color:#f92672">eq</span> <span style="color:#e6db74">&#39;mswin32&#39;</span>) ?? <span style="color:#e6db74">&#39;cls&#39;</span> <span style="color:#f92672">!!</span> <span style="color:#e6db74">&#39;clear&#39;</span>);

    <span style="color:#66d9ef">for</span> (<span style="color:#ae81ff">0</span> <span style="color:#f92672">..</span> <span style="color:#ae81ff">4</span>) <span style="color:#f92672">-&gt;</span> $i {
        say @printline[$i];
    }

    say <span style="color:#e6db74">&#34;\nToday is &#34;</span><span style="color:#f92672">~</span><span style="color:#e6db74">qw|Monday Tuesday Wednesday Thursday Friday Saturday Sunday|</span>[$dig_time<span style="color:#f92672">.</span>day<span style="color:#f92672">-</span>of<span style="color:#f92672">-</span>week<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    <span style="color:#f92672">~</span><span style="color:#e6db74">&#34;: &#34;</span><span style="color:#f92672">~</span><span style="color:#e6db74">qw|January February March April May June July August September October November December|</span>[$dig_time<span style="color:#f92672">.</span>month<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
    <span style="color:#f92672">~</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">~</span>$dig_time<span style="color:#f92672">.</span>day<span style="color:#f92672">~</span><span style="color:#e6db74">&#34;,&#34;</span>
    <span style="color:#f92672">~</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#f92672">~</span>$dig_time<span style="color:#f92672">.</span>year;
    sleep <span style="color:#ae81ff">.5</span>
}
</code></pre></div><p>which produces output like so:</p>
<pre><code> 222222  333333      44  44   0000       333333   0000
     22      33  ::  44  44  00  00  ::      33  00  00
 222222  333333      444444  00  00      333333  00  00
 22          33  ::      44  00  00  ::      33  00  00
 222222  333333          44   0000       333333   0000
</code></pre>
<h2 id="see-also">SEE ALSO</h2>
<p>Only one blog post (besides mine) this time, as far as I can say from Mohammad&rsquo;s recap and from the GitHub repository:</p>
<p>Arne Sommer: <a href="https://perl6.eu/binary-clock.html">https://perl6.eu/binary-clock.html</a>.</p>
<h2 id="wrapping-up">Wrapping up</h2>
<p>Please let me know if I forgot any of the challengers or if you think my explanation of your code misses something important (send me an e-mail or just raise an issue against this GitHub page).</p>
<p>If you want to participate to the Perl Weekly Challenge, please connect to <a href="https://perlweeklychallenge.org/">this site</a>.</p>

                </div>
            </div>
        </div>
    </div>
</section>


<!-- Call To Action Section Start -->
<section id="call-to-action">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="block">
                    <h2 class="title wow fadeInDown" data-wow-delay=".3s" data-wow-duration="500ms">SO WHAT DO YOU THINK ?</h2>
                    <p class="wow fadeInDown" data-wow-delay=".5s" data-wow-duration="500ms">If you have any suggestions or ideas then please do share with us.</p>
                    <a href="/contact" class="btn btn-default btn-contact wow fadeInDown" data-wow-delay=".7s" data-wow-duration="500ms">Contact with me</a>
                </div>
            </div>

        </div>
    </div>
</section>
<!-- Call To Action Section End -->



<!-- Footer Section Start -->
<footer id="footer">
    <div class="container">
        <div class="row content-justify-between">
            <div class="col-md-8 col-12 text-center text-lg-left text-md-left">
                <p class="copyright">Copyright:
                    <span>
                        2020
                    </span> PerlWeeklyChallenge. Theme Design and Developed by
                    <a href="http://www.Themefisher.com" rel="noreferrer" rel="noreferrer" target="_blank">Themefisher</a>.
                </p>
            </div>
            <div class="col-md-4 col-12">
                <!-- Social Media -->
                <ul class="social text-center text-md-right text-lg-right">
                    <li>
                        <a href="https://twitter.com/PerlWChallenge" class="twitter" rel="noreferrer" target="_blank" title="Follow us">
                            <i class="ion-social-twitter"></i>
                        </a>
                    </li>
                    <li>
                        <a href="/rss.xml" class="rss" target="_blank" title="RSS Feed">
                            <i class="ion-social-rss"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://www.nomtimes.co.uk/site/shop.do?cref=PerlBooks" title="Free Perl Books" rel="noreferrer" target="_blank">
                            <img src="/images/NomTimes.jpg" style="width:22px; height: 18px;" alt=""/>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
<!-- footer section end -->

<!-- jquery -->
<script src="https://perlweeklychallenge.org/plugins/jQurey/jquery.min.js"></script>
<!-- Form Validation -->
<script src="https://perlweeklychallenge.org/plugins/form-validation/jquery.form.min.js"></script>
<script src="https://perlweeklychallenge.org/plugins/form-validation/jquery.validate.min.js"></script>
<!-- slick slider -->
<script src="https://perlweeklychallenge.org/plugins/slick/slick.min.js"></script>
<!-- bootstrap js -->
<script src="https://perlweeklychallenge.org/plugins/bootstrap/bootstrap.min.js"></script>
<!-- chart js -->
<script src="https://perlweeklychallenge.org/plugins/chart/highstock.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/drilldown.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/data.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/chart.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/pwc-challenge.js"></script>
<script src="https://perlweeklychallenge.org/plugins/chart/gc-challenge.js"></script>
<!-- wow js -->
<script src="https://perlweeklychallenge.org/plugins/wow-js/wow.min.js"></script>
<!-- slider js -->
<script src="https://perlweeklychallenge.org/plugins/slider/slider.js"></script>
<!-- Fancybox -->
<script src="https://perlweeklychallenge.org/plugins/facncybox/jquery.fancybox.js"></script>
<!-- template main js -->

<script src="https://perlweeklychallenge.org/js/script.min.js"></script>
<!-- google analitycs -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-136524905-1', 'auto');
    ga('send', 'pageview');
</script>
</body>

</html>

